<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸš€ GitHub Webhook Dashboard</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f4f6f8;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #2d3436;
      margin-bottom: 30px;
    }

    .event-card {
      background-color: #ffffff;
      border-left: 6px solid #0984e3;
      margin: 15px auto;
      max-width: 700px;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      transition: transform 0.2s ease;
    }

    .event-card:hover {
      transform: scale(1.02);
    }

    .event-type {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
    }

    .event-type span {
      background-color: #dfe6e9;
      color: #2d3436;
      border-radius: 12px;
      font-size: 12px;
      padding: 4px 8px;
      margin-left: 10px;
    }

    .event-message {
      font-size: 15px;
      color: #444;
      margin-bottom: 8px;
    }

    .timestamp {
      font-size: 13px;
      color: #2d3436;
      font-weight: 500;
      background-color: #dfe6e9;
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      margin-top: 8px;
    }

    .push       { border-left-color: #0984e3; }
    .pr         { border-left-color: #6c5ce7; }
    .merge      { border-left-color: #00b894; }
    .review     { border-left-color: #fdcb6e; }
    .release    { border-left-color: #e17055; }
    .issue      { border-left-color: #d63031; }
    .member     { border-left-color: #00cec9; }
  </style>
</head>
<body>
  <h1>ðŸ“Š GitHub Webhook Activity Feed</h1>

  <div id="event-container"></div>

  <script>
    async function fetchEvents() {
      try {
        const res = await fetch('/events');
        const data = await res.json();
        const container = document.getElementById('event-container');
        container.innerHTML = '';

        data.forEach(event => {
          const div = document.createElement('div');
          div.classList.add('event-card');

          const typeClass = {
            push: 'push',
            pull_request: 'pr',
            merge: 'merge',
            pull_request_review: 'review',
            release: 'release',
            issue: 'issue',
            member: 'member'
          }[event.type];

          if (typeClass) div.classList.add(typeClass);

          const typeLabel = {
            push: 'Push',
            pull_request: 'Pull Request',
            merge: 'Merge',
            pull_request_review: 'PR Review',
            release: 'Release',
            issue: 'Issue',
            member: 'Member Change'
          }[event.type] || event.type;

          let message = '';

          if (event.type === 'push') {
            message = `${event.author} pushed to branch <strong>${event.to_branch}</strong>`;
          } else if (event.type === 'pull_request') {
            message = `${event.author} opened a pull request from <strong>${event.from_branch}</strong> to <strong>${event.to_branch}</strong>`;
          } else if (event.type === 'merge') {
            message = `${event.author} merged <strong>${event.from_branch}</strong> into <strong>${event.to_branch}</strong>`;
          } else if (event.type === 'pull_request_review') {
            message = `${event.author} reviewed a pull request (state: <strong>${event.state}</strong>)`;
          } else if (event.type === 'release') {
            message = `${event.author} published a release <strong>${event.tag}</strong>`;
          } else if (event.type === 'issue') {
            message = `${event.author} opened an issue titled "<strong>${event.title}</strong>"`;
          } else if (event.type === 'member') {
            message = `${event.author} <strong>${event.action}</strong> member <strong>${event.member}</strong>`;
          }

          div.innerHTML = `
            <div class="event-type">
              ðŸ“Œ ${typeLabel} <span>${event.type}</span>
            </div>
            <div class="event-message">${message}</div>
            <div class="timestamp">ðŸ•’ ${event.timestamp}</div>
          `;

          container.appendChild(div);
        });
      } catch (error) {
        console.error("Error fetching events:", error);
      }
    }

    fetchEvents();
    setInterval(fetchEvents, 15000);
  </script>
</body>
</html>